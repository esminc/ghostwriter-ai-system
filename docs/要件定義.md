# 代筆さん機能 要件定義書

## 1. 機能概要

### 機能名
**代筆さん (Ghostwriter for esa Diary)**

### 目的
- チームメンバーの日記投稿負担を軽減
- 継続的な日記文化の維持支援
- 個人の文体・スタイルを学習した高品質な代筆投稿の実現

### 対象ユーザー
- ESM ITS チームメンバー
- esa日記を書いている（または書くべき）全員

## 2. 機能仕様

### 2.1 基本フロー
```
1. ユーザー名指定 → 2. プロファイル分析 → 3. 行動入力/生成 → 4. 日記生成 → 5. esa投稿
```

### 2.2 詳細機能

#### A. プロファイル分析機能
**入力**
- 対象ユーザー名（esa screen_name）

**処理**
- esa APIで過去の記事を検索・取得
- 文体、語調、よく使う表現の分析
- 技術的関心、趣味、性格的特徴の抽出
- 日記フォーマット（構成パターン）の学習

**出力**
- ユーザープロファイル（文体スタイル、関心事、フォーマット情報）

#### B. 行動情報入力・生成機能
**入力方式**
- **手動入力**: その日の実際の行動・出来事を箇条書きで入力
- **自動生成**: ユーザープロファイルに基づいた架空の日常行動を生成

**生成ロジック**
- 過去の行動パターンから推測
- 曜日・時期に応じた適切な行動
- そのユーザーらしい技術的活動・学習内容

#### C. 日記生成機能
**生成要素**
- **タイトル**: 【代筆】{ユーザー名}:{日記タイトル}
- **本文構成**: 
  - やることやったこと
  - TIL (Today I Learned)
  - こんな気分
- **文体**: 対象ユーザーの文体を模倣
- **内容**: リアリティのある日常と技術的学習内容

#### D. esa投稿機能
**投稿先**
- カテゴリ: `日記/{YYYY}/{MM}/{DD}/`
- 記事種別: flow
- タグ: 自動付与（代筆、ユーザー名など）

## 3. 技術要件

### 3.1 使用技術・API
- **esa API**: 記事検索・取得・投稿
- **生成AI**: GPT-4/Claude for 文章生成
- **自然言語処理**: 文体分析・特徴抽出
- **MCP対応**: Model Context Protocol準拠

### 3.2 データ要件
- **プロファイルデータ**: JSON形式でキャッシュ
- **学習データ**: 過去N件の日記記事（推奨: 直近50-100件）
- **テンプレート**: 日記フォーマットのテンプレート保存

### 3.3 性能要件
- **プロファイル分析**: 初回5分以内、キャッシュ利用時30秒以内
- **日記生成**: 2分以内
- **投稿処理**: 30秒以内

## 4. ユーザーインターフェース

### 4.1 入力インターフェース
```
代筆さん起動コマンド例:
"okamoto-takuyaの代筆お願いします"
"【代筆モード】ユーザー: okamoto-takuya"
```

### 4.2 対話フロー
```
1. 🤖「どちらの代筆をいたしましょうか？」
   👤「okamoto-takuyaさん」

2. 🤖「プロファイル分析中...（過去87件の記事を分析）」
   🤖「今日の行動を教えてください。省略する場合は『おまかせ』と入力してください」
   👤「・バグ修正作業 ・新人のコードレビュー ・MCP勉強」

3. 🤖「日記を生成しています...」
   🤖「以下の内容で投稿しますか？」
   [プレビュー表示]
   👤「はい」

4. 🤖「投稿完了しました！記事URL: https://esminc-its.esa.io/posts/xxx」
```

## 5. 制約・考慮事項

### 5.1 セキュリティ・プライバシー
- **権限管理**: 自分以外の代筆は管理者権限必要
- **内容確認**: 投稿前のプレビュー・承認必須
- **個人情報**: センシティブな情報の自動除外

### 5.2 品質管理
- **代筆表示**: タイトルに【代筆】明記必須
- **リアリティ**: 明らかに嘘とわかる内容の回避
- **一貫性**: 過去の投稿との矛盾チェック

### 5.3 運用制限
- **頻度制限**: 同一ユーザーの代筆は週2回まで
- **承認フロー**: 初回代筆は本人確認必要
- **品質監視**: 不適切な内容の自動検出

## 6. 成功指標

### 6.1 機能品質
- **文体再現度**: 本人作成記事との類似度80%以上
- **投稿成功率**: 95%以上
- **ユーザー満足度**: 4.0/5.0以上

### 6.2 利用状況
- **利用率**: チームメンバーの50%以上が月1回利用
- **継続性**: 日記投稿頻度の向上（20%以上）
- **エンゲージメント**: 代筆記事への反応率

## 7. 実装フェーズ

### Phase 1: MVP (最小実用版)
- 基本的なプロファイル分析
- 手動行動入力による日記生成
- 簡単なesa投稿機能

### Phase 2: 機能拡張
- 行動自動生成機能
- 文体学習の高度化
- UIの改善

### Phase 3: 高度化
- 複数ユーザー対応
- スケジュール投稿
- チーム文化に特化した機能

## 8. リスクと対策

### 8.1 技術リスク
- **API制限**: esa API率制限への対策（キャッシュ、バッチ処理）
- **AI品質**: 生成内容の品質担保（プロンプトエンジニアリング）

### 8.2 運用リスク
- **悪用防止**: 権限管理とログ記録
- **文化への影響**: 本物の日記文化への悪影響回避

### 8.3 法的リスク
- **著作権**: 文体模倣の法的問題（社内利用前提で回避）
- **プライバシー**: 個人情報の適切な取り扱い

---

## 次のステップ
1. **プロトタイプ開発**: Phase 1のMVP実装
2. **ユーザーテスト**: 限定メンバーでのβテスト
3. **フィードバック収集**: 改善点の洗い出し
4. **本格運用**: チーム全体への展開