# 🧪 GhostWriter 変更時必須テストチェックリスト

## 📋 使用方法

**任意の修正・機能追加後は、必ずこのチェックリストを実行してください。**
1つでも失敗した場合は、変更を取り消して原因を調査してください。

---

## 🔴 **CRITICAL テスト（1つでも失敗したら即座に修正）**

### ✅ システム起動テスト
```bash
# Slackボットが正常に起動するか
npm run slack:dev
```
- [ ] エラーなく起動完了
- [ ] "⚡️ GhostWriter Slack Bot is running" メッセージ表示
- [ ] ポート3000でリスニング開始

### ✅ 核心機能テスト
```bash
# Phase 5.3システムのテスト実行
node test-phase53-complete.js
```
- [ ] システム初期化成功
- [ ] 日記生成成功（361文字程度）
- [ ] エラー: 0件
- [ ] 品質スコア: 4.0以上

### ✅ 必須メソッド存在確認
```javascript
// Phase 5.3 Unified クラスの必須メソッド
const generator = new LLMDiaryGeneratorPhase53Unified();
```
- [ ] `generateDiaryWithMCP()` メソッド存在
- [ ] `generatePersonalizedDiaryContent()` メソッド存在  
- [ ] `generateCleanQualityFooter()` メソッド存在
- [ ] `postToEsaWithMCP()` メソッド存在

---

## 🟡 **品質保証テスト（品質劣化の検出）**

### ✅ 日記内容品質チェック
生成された日記で以下を確認：

#### 開発情報除外チェック
- [ ] 本文に「Phase」「MCP」「API」「システム」「統合」「完成版」「修正版」が含まれていない
  ※ ただしesa/Slackからの実際のデータに含まれる場合は除外
- [ ] AIが不自然に技術用語を追加していない
- [ ] 情報源が実際の活動記録であれば禁止用語でも自然に掲載
- [ ] ユーザーの個人的な活動のみが記載されている

#### 構造完整性チェック
- [ ] タイトル: `【代筆】{userName}: {日付}の振り返り` 形式
- [ ] 本文構造: やったこと → 学んだこと → 感想・反省
- [ ] フッター: 🤖 AI統合システム情報セクション存在
- [ ] 文字数: 300-800文字の範囲内

#### 個人化品質チェック
- [ ] 自然で個人的な語調
- [ ] ユーザー固有の活動への言及
- [ ] 過去の投稿パターンの反映

### ✅ 品質フッター検証
- [ ] 「🤖 AI統合システム情報」セクション存在
- [ ] 「📊 個人化品質」セクション存在  
- [ ] 「💾 データソース情報」セクション存在
- [ ] 開発システム詳細がフッターに含まれていない

---

## 🟢 **統合テスト（実際の動作確認）**

### ✅ Slackコマンドテスト
Slackで実際に以下を実行：

```
/ghostwrite
```
- [ ] 対話的UIが正常表示
- [ ] "✍️ AI代筆生成" ボタンが動作
- [ ] 日記プレビューが正常表示
- [ ] "🚀 esaに投稿" ボタンが動作

### ✅ esa投稿テスト
- [ ] MCP経由でesa投稿成功
- [ ] 投稿者が「esa_bot」になっている
- [ ] WIP（下書き）として投稿される
- [ ] 投稿URLが正常に生成される

### ✅ エラーハンドリングテスト
- [ ] MCP接続失敗時にフォールバック動作
- [ ] API制限時に適切なエラーメッセージ
- [ ] 不正な入力でもシステムクラッシュしない

---

## 🔍 **詳細検証テスト（品質保証）**

### ✅ パフォーマンステスト
- [ ] 日記生成時間: 30秒以内
- [ ] メモリ使用量: 正常範囲
- [ ] MCP接続タイムアウト: 適切に処理

### ✅ データ整合性テスト
- [ ] ユーザーマッピングが正常動作
- [ ] プロフィール分析データが適切に取得
- [ ] 履歴データが正常保存される

### ✅ セキュリティテスト
- [ ] 環境変数が適切に保護されている
- [ ] APIキーが平文でログ出力されていない
- [ ] ユーザーデータが適切に処理されている

---

## 📊 **品質メトリクス確認**

### 必須達成指標
- [ ] エラー率: 0%
- [ ] 生成成功率: 100%
- [ ] 個人化品質: 4.0/5 以上
- [ ] AI分析品質: 4.5/5 以上

### 内容品質指標  
- [ ] 開発情報混入率: 0%
- [ ] ユーザー活動反映率: 100%
- [ ] 構造完整性: 100%

---

## 🚨 **失敗時の対応手順**

### Critical テスト失敗時
1. **即座に変更を取り消す**
2. エラーログを詳細に調査
3. 根本原因を特定
4. 修正後、再度全テストを実行

### 品質テスト失敗時
1. 品質劣化の範囲を特定
2. 仕様書との差異を確認
3. 最小限の修正で品質を回復
4. 品質メトリクスが回復するまで調整

### 統合テスト失敗時
1. 個別コンポーネントのテストを実行
2. 統合ポイントでの問題を特定
3. インターフェース仕様を再確認
4. 段階的に統合テストを再実行

---

## 📝 **テスト実行記録テンプレート**

```markdown
## テスト実行記録
- **実行日時**: YYYY-MM-DD HH:MM:SS
- **変更内容**: [変更の概要]
- **実行者**: [担当者名]

### Critical テスト結果
- [ ] システム起動: 成功/失敗
- [ ] 核心機能: 成功/失敗  
- [ ] 必須メソッド: 成功/失敗

### 品質保証テスト結果  
- [ ] 日記内容品質: 合格/不合格
- [ ] 品質フッター: 合格/不合格

### 統合テスト結果
- [ ] Slackコマンド: 成功/失敗
- [ ] esa投稿: 成功/失敗
- [ ] エラーハンドリング: 合格/不合格

### 全体評価
- **結果**: 合格/不合格
- **備考**: [特記事項]
```

---

## 💡 **重要な注意事項**

1. **テストを省略しない**
   - 小さな修正でも必ず実行
   - 「動いているから大丈夫」は厳禁

2. **失敗を隠さない**  
   - 1つでも失敗があれば報告
   - 原因を必ず調査・記録

3. **品質基準を下げない**
   - 仕様書の品質基準は絶対
   - 妥協案ではなく根本解決を

---

**このチェックリストは「品質の守護者」です。**  
**すべての変更後に必ず実行し、GhostWriterの品質を守ってください。**

---

*最終更新: 2025-06-05*  
*バージョン: v1.0*